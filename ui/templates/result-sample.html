<div id="table-wrapper">
    <table id="main-result">
        <thead>
            {% if url_base %}
            <tr id="phenopackets">
                <td colspan="11">
                    <div>
                        <img src="http://phenopackets.org/site/PhenoPackets_Logo.png" alt="Phenopackets">
                        <form action="{{ url_base }}" method="post" target="_blank">
                            <input type="hidden" name="requestedSchema" value="ga4gh-phenopacket-biosample-v1.0">
                            {% for param, value in url_parameters.items() %}
                                <input type="hidden" name="{{param}}" value="{{value}}">
                            {% endfor %}
                            <input type="submit" value="Response">
                        </form>
                        <a href="data:text/plain;base64,{{ hts_files }}" download="hts_files.txt">List of files</a>
                    </div>

                </td>
            </tr>
            {% endif %}
            <tr>
                <th class="extra-info-trigger"></th>
                <th>Biosample ID</th>
                <th>Subject ID</th>
                <th>Description</th>
                <th>Biosample Status</th>
                <th>Obtention Procedure</th>
                <th>Subject Age at Collection</th>
                <th>Collection Date</th>
                <th>Alternative IDs</th>
                <th>Study ID</th>
                <th>Bioproject ID</th>
            </tr>
        </thead>
        <tbody>
            {% for record in records %}
                <tr>
                    <td class="extra-info-trigger" title="Click to open a side panel with extra information."><i class="far fa-plus-square"></i></td>
                    <td>{{ record.biosample_stable_id|default("-",true) }}</td>
                    <td>{{ record.individual_stable_id|default("-",true) }}</td>
                    <td>{{ record.description|default("-",true) }}</td>
                    <td title="Ontology term: {{record.biosample_status_ontology|default("-",true)}}">{{ record.biosample_status_ontology_label|default("-",true) }}</td>
                    <td title="Ontology term: {{record.obtention_procedure_ontology|default("-",true)}}">{{ record.obtention_procedure_ontology_label|default("-",true) }}</td>
                    <td>{{ record.individual_age_at_collection|default("-",true) }}</td>
                    <td>{{ record.collection_date|default("-",true) }}</td>
                    <td>{{ record.alternative_ids|default("-",true)|join(", ") }}</td>
                    <td>{{ record.study_id|default("-",true) }}</td>
                    <td>{{ record.bioproject_id|default("-",true) }}</td>

                    <td class="hidden">
                        <h1><i class="fas fa-times close-button"></i>Sample {{ record.biosample_stable_id|default("-",true) }}</h1>
                        <section>
                            <h2>Tumor Parameters</h2>
                            <div class="extra-info-table-wrapper">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>tumorProgression</th>
                                            <th>tumorGrade</th>                            
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            {% if record.tumor_progression_ontology %}<td><td title="Ontology term: {{record.tumor_progression_ontology|default("-",true)}}">{{ record.tumor_progression_ontology_label }}</td></td>{% endif %}
                                            {% if record.tumor_grade_ontology %}<td><td title="Ontology term: {{record.tumor_grade_ontology|default("-",true)}}">{{ record.tumor_grade_ontology_label }}</td></td>{% endif %}
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </section>
                        <section>
                            <h2>Sample Origins</h2>
                            <div class="extra-info-table-wrapper">
                                <table>
                                    <thead>
                                        <tr>
                                            <th>sampleOriginType</th>
                                            <th>sampleOriginDetail</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for sample in record.sample_origins.parsed %}
                                        <tr>
                                            <td>{{ sample.sampleOriginType|default("-",true) }}</td>
                                            <td>{{ sample.sampleOriginDetail|default("-",true) }}</td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </section>
                        <section>
                            <h2>Handovers</h2>
                            <div class="extra-info-table-wrapper">
                                <table>
                                    <thead>
                                        <tr>
                                            <th></th>
                                            <th>note</th>
                                            <th>url</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for handover in record.handovers.parsed %}
                                        <tr>
                                            <td class="handover-cell">
                                                <a href="{{handover.url}}" target="_blank"><i class="fas fa-external-link-alt"></i></a>
                                            </td>
                                            <td>{{ handover.note }}</td>
                                            <td class="handover-cell"><a href="{{handover.url}}" target="_blank">{{ handover.url }}</a></td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<div id="extra-info" class="hidden">
</div>